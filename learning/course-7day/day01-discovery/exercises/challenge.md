# Day 1 练习：维护挑战

## 任务说明

你有15分钟时间在 `ai-generated-app/message-handler.js` 中实现频率限制功能。

## 需求

1. 每个用户每分钟最多发送 **10条消息**
2. 超过限制时，返回错误提示：`{ error: '发送太频繁' }`
3. 不能影响现有其他功能

## 提示（可选阅读）

<details>
<summary>点击查看提示（如果需要帮助）</summary>

### 提示1：数据存在哪里？

你需要一个地方存储每个用户的发送记录。考虑：
- 内存里？用什么数据结构？
- 存在哪里初始化？

### 提示2：什么时候检查？

应该在什么时候检查频率：
- 消息刚收到时？
- 处理中间件时？
- 处理器执行后？

### 提示3：如何清理过期数据？

如果只记录不清理，内存会无限增长。考虑：
- 什么时候清理过期的记录？
- 如何知道哪些记录过期了？

</details>

## 计时开始

**开始时间：** ______ : ______

**结束时间：** ______ : ______

---

## 反思问题

完成后请回答以下问题：

### 1. 定位难度（1-5分）

找到该改的位置花了多长时间？
- 1分：马上找到
- 5分：找了很久都没把握

**你的评分：** ___

### 2. 信心程度（1-5分）

你确定改的地方是对的吗？
- 1分：非常确定
- 5分：完全不确定

**你的评分：** ___

### 3. 修改难度（1-5分）

实际修改代码的复杂度如何？
- 1分：非常简单
- 5分：非常复杂，改了多处

**你的评分：** ___

### 4. 测试难度（1-5分）

你能确定修改后不影响其他功能吗？
- 1分：完全确定
- 5分：不知道会出什么问题

**你的评分：** ___

---

## 总分统计

**总难度分：** ___ / 20

- 4-8分：代码结构不错
- 9-14分：代码结构一般
- 15-20分：**维护地狱**

---

## 与模型思维版对比

现在请查看 `examples/human-maintain/message-handler-modeled.js` 中的实现：

1. 找到 `RateLimiter` 类 - 这就是频率限制的实现
2. 看到它是如何被注入到 `MessageService` 的
3. 注意它的职责单一，易于修改

**思考：**
- 如果在模型思维版中修改限制次数，需要改哪里？
- 如果需要把存储从内存换成Redis，需要改哪里？
- 如果要添加新的限制规则（如图片大小限制），需要改哪里？

---

## 心得记录

用一句话总结今天的体验：

```
_________________________________________________________________
```

---

## 预习问题

为明天的课程做准备，思考：

1. 什么是"模型"？你能用自己的话解释吗？
2. OpenClaw 可能有哪些"领域"？
3. 为什么"画模型"比"直接写代码"更重要？

---

*完成此练习后，你已经体验了"维护地狱"。明天，我们将学习如何用"模型思维"避免这种地狱。*
